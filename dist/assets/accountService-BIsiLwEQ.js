import{a as e,b as r,_ as t}from"./index-lp4wKaf9.js";import{n as a,c as s,q as n,w as o,b as i,f as c,d}from"./firebase-vendor-B4z9b8il.js";import"./animation-vendor-BD8Aa5RZ.js";import"./react-vendor-DtX1tuCI.js";import"./icons-vendor-BBBaSOmN.js";const u=async e=>{try{const t=s(r,"entries"),a=n(t,o("userId","==",e)),u=(await i(a)).docs.map(e=>c(d(r,"entries",e.id)));await Promise.all(u)}catch(t){throw new Error("Failed to delete user data")}},m=async()=>{const r=e.currentUser;if(!r)throw new Error("No user is currently signed in");try{await u(r.uid),await a(r)}catch(t){if("auth/requires-recent-login"===t.code)throw new Error("For security reasons, please log out and log back in before deleting your account.");throw new Error(`Failed to delete account: ${t.message}`)}},p=async e=>{try{const a=d(r,"users",e,"private","usage"),s=await t(()=>import("./firebase-vendor-B4z9b8il.js").then(e=>e.p),[]).then(e=>e.getDoc(a));return s.exists()?s.data():{transcriptionSeconds:0,aiSummaryCount:0}}catch(a){return{transcriptionSeconds:0,aiSummaryCount:0}}},w=async(e,a)=>{try{const s=d(r,"users",e,"private","usage"),{setDoc:n,increment:o}=await t(async()=>{const{setDoc:e,increment:r}=await import("./firebase-vendor-B4z9b8il.js").then(e=>e.p);return{setDoc:e,increment:r}},[]);await n(s,{transcriptionSeconds:o(a),lastUpdated:Date.now()},{merge:!0})}catch(s){}};export{m as deleteAccount,u as deleteAllUserData,p as getUserUsage,w as updateUserUsage};
