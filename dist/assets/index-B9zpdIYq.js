const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HistoryDashboard-BuaRsKSh.js","assets/animation-vendor-BD8Aa5RZ.js","assets/react-vendor-DtX1tuCI.js","assets/icons-vendor-DZrg139Q.js","assets/firebase-vendor-BCiydsH2.js","assets/SettingsModal-BpnzfDNH.js","assets/ContactModal-CMv61ntK.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,a,r)=>((t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r)(t,"symbol"!=typeof a?a+"":a,r);import{j as a,A as r,m as n}from"./animation-vendor-BD8Aa5RZ.js";import{a as s,r as o,R as i}from"./react-vendor-DtX1tuCI.js";import{i as l,g as c,G as d,a as u,c as m,q as h,o as g,b as p,d as x,e as f,f as y,s as b,h as w,j as v,k as j,l as k,m as N,u as S,n as W}from"./firebase-vendor-BCiydsH2.js";import{B as C,I as D,H as z,a as E,L as T,b as O,A as I,S as M,P as A,c as L,d as _,X as $,M as H,C as P,e as U,f as R,T as F,g as G,F as B,h as J,i as Y,j as V,k as q,l as K,m as Z,Z as Q,n as X,o as ee,p as te,q as ae,r as re}from"./icons-vendor-DZrg139Q.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ne={},se=s;ne.createRoot=se.createRoot,ne.hydrateRoot=se.hydrateRoot;const oe={},ie=function(e,t,a){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),a=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in oe)return;oe[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,a&&n.setAttribute("nonce",a),document.head.appendChild(n),t?new Promise((t,a)=>{n.addEventListener("load",t),n.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})},le="dj_device_key_v1";async function ce(){let e=localStorage.getItem(le);if(!e){const e=await window.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),t=await window.crypto.subtle.exportKey("jwk",e);return localStorage.setItem(le,JSON.stringify(t)),e}return window.crypto.subtle.importKey("jwk",JSON.parse(e),{name:"AES-GCM"},!0,["encrypt","decrypt"])}async function de(e){try{const t=await ce(),a=window.crypto.getRandomValues(new Uint8Array(12)),r=(new TextEncoder).encode(e),n=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:a},t,r),s=new Uint8Array(n),o=new Uint8Array(a.length+s.length);o.set(a),o.set(s,a.length);let i="";const l=o.byteLength;for(let e=0;e<l;e++)i+=String.fromCharCode(o[e]);return btoa(i)}catch(t){return e}}async function ue(e){try{const t=await ce(),a=atob(e),r=a.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=a.charCodeAt(e);const s=n.slice(0,12),o=n.slice(12),i=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:s},t,o);return(new TextDecoder).decode(i)}catch(t){return""}}const me=l({apiKey:"AIzaSyDfN8DoYPyJbVM3y3MWaFdz0mhrpqLFuZo",authDomain:"data-journaling.firebaseapp.com",projectId:"data-journaling",storageBucket:"data-journaling.firebasestorage.app",messagingSenderId:"738602468552",appId:"1:738602468552:web:abfffbe405bd8f3f1a11fd",measurementId:"G-QNHEJD6HV4"}),he=c(me),ge=new d,pe=u(me),xe="data_journaling_entries_secure_v1",fe="dj_manifest_v1",ye="dj_entry_";async function be(){const e=localStorage.getItem(fe);if(!e)return[];try{const t=await ue(e);return JSON.parse(t)}catch{return[]}}async function we(e){const t=await be();if(!t.includes(e)){t.push(e),t.sort((e,t)=>t.localeCompare(e));const a=await de(JSON.stringify(t));localStorage.setItem(fe,a)}}const ve=async e=>{const t=await be();if(0!==t.length){for(const r of t){const t=localStorage.getItem(ye+r);if(t)try{const a=await ue(t),n=JSON.parse(a);await b(f(pe,"users",e,"entries",r),n),localStorage.removeItem(ye+r)}catch(a){}}localStorage.removeItem(fe)}},je=async()=>{const e=localStorage.getItem(xe);if(e)try{const t=await ue(e);if(!t)return;const a=JSON.parse(t);for(const e of a){const t=await de(JSON.stringify(e));localStorage.setItem(ye+e.date,t),await we(e.date)}localStorage.removeItem(xe)}catch(t){}},ke=async e=>{const t=he.currentUser;if(t)try{const a=JSON.parse(JSON.stringify(e));await b(f(pe,"users",t.uid,"entries",e.date),a)}catch(a){throw a}else try{const t=JSON.stringify(e),a=await de(t);localStorage.setItem(ye+e.date,a),await we(e.date)}catch(a){throw a}},Ne=async e=>{const t=he.currentUser;if(t){const a=f(pe,"users",t.uid,"entries",e),r=await y(a);return r.exists()?r.data():void 0}{const t=localStorage.getItem(ye+e);if(!t)return;try{const e=await ue(t);return JSON.parse(e)}catch(a){return}}},Se=async()=>{const e=he.currentUser;if(e){const t=m(pe,"users",e.uid,"entries"),a=h(t,g("date","desc")),r=await p(a),n=[];return r.forEach(e=>{n.push(e.data())}),n}{const e=(await be()).map(async e=>await Ne(e));return(await Promise.all(e)).filter(e=>void 0!==e).sort((e,t)=>t.timestamp-e.timestamp)}},We=async e=>{const t=he.currentUser;t?await x(f(pe,"users",t.uid,"entries",e)):(await async function(e){const t=(await be()).filter(t=>t!==e),a=await de(JSON.stringify(t));localStorage.setItem(fe,a)}(e),localStorage.removeItem(ye+e))},Ce=async()=>{let e=[];const t=he.currentUser;if(t){const a=m(pe,"users",t.uid,"entries");(await p(a)).forEach(t=>e.push(t.id))}else e=await be();if(0===e.length)return 0;const a=[...e].sort((e,t)=>t.localeCompare(e));let r=0;const n=new Date;n.setHours(0,0,0,0);const s=new Date(a[0]);s.setHours(0,0,0,0);const o=Math.abs(n.getTime()-s.getTime());if(Math.round(o/864e5)>1)return 0;r=1;for(let i=0;i<a.length-1;i++){const e=new Date(a[i]),t=new Date(a[i+1]);e.setHours(0,0,0,0),t.setHours(0,0,0,0);if(1!==Math.round((e.getTime()-t.getTime())/864e5))break;r++}return r},De=Object.freeze(Object.defineProperty({__proto__:null,deleteEntry:We,getEntries:Se,getEntryByDate:Ne,getStreak:Ce,migrateLocalToCloud:ve,runMigration:je,saveEntry:ke},Symbol.toStringTag,{value:"Module"})),ze=o.createContext(void 0),Ee=({children:e})=>{const[t,r]=o.useState(null),[n,s]=o.useState(!1),[i,l]=o.useState(!0),[c,d]=o.useState(!1),[u]=o.useState(!1),[m]=o.useState({transcriptionSeconds:0,aiSummaryCount:0});o.useEffect(()=>w(he,async e=>{e?(r(e),s(!1),await ve(e.uid)):r(null),l(!1)}),[]),o.useEffect(()=>{const e=localStorage.getItem("dj_theme");("dark"===e||!e&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(d(!0),document.documentElement.classList.add("dark"))},[]);return a.jsx(ze.Provider,{value:{user:t,isGuest:n,loading:i,darkMode:c,isPro:u,usage:m,loginGoogle:async()=>{try{l(!0),await N(he,ge)}catch(e){throw l(!1),e}},loginEmail:async(e,t)=>{try{l(!0),await k(he,e,t)}catch(a){throw l(!1),a}},registerEmail:async(e,t)=>{try{l(!0),await j(he,e,t)}catch(a){throw l(!1),a}},loginGuest:()=>{s(!0)},logout:async()=>{try{await v(he),r(null),s(!1)}catch(e){}},toggleDarkMode:()=>{d(e=>{const t=!e;return t?(document.documentElement.classList.add("dark"),localStorage.setItem("dj_theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("dj_theme","light")),t})}},children:e})},Te=()=>{const e=o.useContext(ze);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},Oe=i.memo(({value:e,onChange:t})=>a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("div",{className:"flex gap-1 bg-gray-100/50 dark:bg-white/5 p-1 rounded-lg",children:[{value:-2,label:"-2"},{value:-1,label:"-1"},{value:0,label:"0"},{value:1,label:"+1"},{value:2,label:"+2"}].map(r=>a.jsx("button",{onClick:()=>t(r.value),className:`\n              w-8 h-8 flex items-center justify-center rounded-md text-sm font-medium transition-all duration-200\n              ${e===r.value?"bg-white dark:bg-zinc-700 text-black dark:text-white shadow-sm scale-105":"text-gray-400 dark:text-gray-500 hover:bg-white/50 dark:hover:bg-white/10 hover:text-gray-600 dark:hover:text-gray-300"}\n            `,title:`Rate as ${r.value}`,children:r.label},r.value))})})),Ie=({prompts:e,className:t})=>{const[s,i]=o.useState(0);return o.useEffect(()=>{const t=setInterval(()=>{i(t=>(t+1)%e.length)},5e3);return()=>clearInterval(t)},[e]),a.jsx("div",{className:`pointer-events-none absolute top-0 left-0 w-full h-full p-0 overflow-hidden ${t}`,children:a.jsx(r,{mode:"wait",children:a.jsx(n.span,{initial:{opacity:0},animate:{opacity:.3},exit:{opacity:0},transition:{duration:.4,ease:"easeInOut"},className:"block",children:e[s]},s)})})},Me=i.memo(({value:e,onChange:t,placeholder:r,animatedPlaceholder:n,minHeight:s="120px"})=>{const i=o.useRef(null),[l,c]=o.useState(!1),[d,u]=o.useState({top:0,left:0});o.useEffect(()=>{if(i.current&&i.current.innerHTML!==e){if(""===e&&"<br>"===i.current.innerHTML)return;i.current.innerHTML=e}},[e]);const m=()=>{const e=window.getSelection();if(!e||0===e.rangeCount)return null;const t=e.getRangeAt(0).getBoundingClientRect();return{top:t.top+window.scrollY,left:t.left+window.scrollX,width:t.width,height:t.height}},h=()=>{var e,t;const a=window.getSelection();if(a&&a.toString().length>0&&(null==(e=i.current)?void 0:e.contains(a.anchorNode))){const e=m();if(e){const t=200;let a=e.left+e.width/2-t/2;a=Math.max(10,Math.min(window.innerWidth-t-10,a)),u({top:e.top-52,left:a}),c(!0)}}else{((null==(t=i.current)?void 0:t.textContent)||"").includes("/")||c(!1)}};o.useEffect(()=>(document.addEventListener("selectionchange",h),()=>document.removeEventListener("selectionchange",h)),[]);const g=(e,a=void 0)=>{if(document.execCommand(e,!1,a),i.current){const e=i.current.innerHTML;i.current.innerHTML=e.replace(/\/$/g,""),t(i.current.innerHTML),i.current.focus({preventScroll:!0})}c(!1)},p=({icon:e,command:t,arg:r,label:n})=>a.jsx("button",{type:"button",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),g(t,r)},className:"p-1.5 rounded-md text-gray-600 dark:text-gray-300 hover:text-apple-blue hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors",title:n,children:a.jsx(e,{className:"w-4 h-4"})});return a.jsxs("div",{className:"relative",children:[l&&a.jsxs("div",{className:"fixed flex items-center gap-1 bg-white dark:bg-zinc-800 backdrop-blur-md border border-gray-200 dark:border-zinc-700 rounded-lg shadow-lg px-2 py-1 z-50 animate-in fade-in zoom-in-95 duration-100",style:{top:`${d.top}px`,left:`${d.left}px`,willChange:"transform"},children:[a.jsx(p,{icon:C,command:"bold",label:"Bold (⌘B)"}),a.jsx(p,{icon:D,command:"italic",label:"Italic (⌘I)"}),a.jsx("div",{className:"w-px h-4 bg-gray-200 dark:bg-zinc-600 mx-1"}),a.jsx(p,{icon:z,command:"formatBlock",arg:"H1",label:"Heading 1"}),a.jsx(p,{icon:E,command:"formatBlock",arg:"H2",label:"Heading 2"}),a.jsx("div",{className:"w-px h-4 bg-gray-200 dark:bg-zinc-600 mx-1"}),a.jsx(p,{icon:T,command:"insertUnorderedList",label:"Bullet List"}),a.jsx(p,{icon:O,command:"insertOrderedList",label:"Numbered List"})]}),a.jsx("style",{children:"\n        .editor-content { line-height: 1.6; }\n        .editor-content p { margin-bottom: 0.3em; }\n        .editor-content ul, .editor-content ol { margin: 0.5em 0; padding-left: 1.5em; }\n        .editor-content li { margin-bottom: 0.3em; padding-left: 0.2em; }\n        .editor-content h1 { font-size: 1.3rem; font-weight: 700; margin-top: 0.5em; margin-bottom: 0.2em; line-height: 1.2; letter-spacing: -0.01em; }\n        .editor-content h2 { font-size: 1.15rem; font-weight: 600; margin-top: 0.4em; margin-bottom: 0.2em; line-height: 1.2; }\n        .editor-content:focus { outline: none; }\n        .editor-content div { margin: 0; }\n        .editor-content br + br { display: none; }\n        \n        /* 3D Layered Fire Animation */\n        @keyframes flicker-layer-1 {\n          0% { transform: scale(1) rotate(-2deg); opacity: 0.8; }\n          25% { transform: scale(1.05) rotate(2deg); opacity: 1; }\n          50% { transform: scale(0.95) rotate(-1deg); opacity: 0.9; }\n          75% { transform: scale(1.1) rotate(1deg); opacity: 1; }\n          100% { transform: scale(1) rotate(-2deg); opacity: 0.8; }\n        }\n        @keyframes flicker-layer-2 {\n          0% { transform: translate(0, 0) scale(0.9); opacity: 0.7; }\n          50% { transform: translate(1px, -2px) scale(1); opacity: 0.9; }\n          100% { transform: translate(0, 0) scale(0.9); opacity: 0.7; }\n        }\n        \n        .animate-fire {\n          position: relative;\n          filter: drop-shadow(0 0 6px rgba(255, 80, 0, 0.6));\n        }\n        .animate-fire::before, .animate-fire::after {\n          content: '';\n          position: absolute;\n          bottom: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          border-radius: 50% 50% 0 0;\n          transform-origin: bottom center;\n          pointer-events: none;\n        }\n        /* Core Flame (Orange) */\n        .animate-fire {\n          animation: flicker-layer-1 0.15s infinite alternate ease-in-out;\n        }\n        /* Inner Flame (Yellow/White) - Simulated with pseudo-element if SVG not used, \n           but since we apply this to an SVG icon, we rely on the filter and transform.\n           To make it truly \"3D\", we add a pulsing glow behind it. */\n        .animate-fire::before {\n          background: radial-gradient(circle, rgba(255,200,0,0.4) 0%, transparent 70%);\n          width: 140%;\n          height: 140%;\n          left: -20%;\n          top: -20%;\n          animation: flicker-layer-2 0.2s infinite alternate-reverse;\n          z-index: -1;\n        }\n      "}),a.jsx("div",{ref:i,className:"editor-content w-full bg-transparent text-base md:text-[17px] text-apple-text dark:text-gray-100 leading-relaxed outline-none font-serif empty:before:content-[attr(data-placeholder)] empty:before:text-gray-300 dark:empty:before:text-zinc-600",contentEditable:!0,onInput:e=>{const a=e.currentTarget.innerHTML;if(t(a),i.current){const e=i.current.textContent||"";if(e.endsWith("/")){const e=m();e&&(u({top:e.top-52,left:e.left}),c(!0))}else if(!e.includes("/")){const e=window.getSelection();e&&0!==e.toString().length||c(!1)}}},onKeyDown:e=>{if("Backspace"===e.key){const t=window.getSelection();if(!t||0===t.rangeCount)return;const a=t.getRangeAt(0);if(0===a.startOffset){const t=a.startContainer.parentElement;if("LI"===(null==t?void 0:t.tagName))return e.preventDefault(),void g("insertUnorderedList")}}if(" "===e.key){const t=window.getSelection();if(!t||0===t.rangeCount)return;const a=t.getRangeAt(0),r=a.startContainer,n=r.textContent||"",s=a.startOffset,o=n.slice(0,s);if(o.endsWith("-")||o.endsWith("*")){if(/^[-*]$/.test(o.trim())){e.preventDefault();const t=n.slice(s);r.textContent=t,g("insertUnorderedList")}}else if(o.endsWith("1.")){if(/^1\.$/.test(o.trim())){e.preventDefault();const t=n.slice(s);r.textContent=t,g("insertOrderedList")}}else if(o.endsWith("#")){if(/^#$/.test(o.trim())){e.preventDefault();const t=n.slice(s);r.textContent=t,g("formatBlock","H1")}}else if(o.endsWith("##")&&/^##$/.test(o.trim())){e.preventDefault();const t=n.slice(s);r.textContent=t,g("formatBlock","H2")}}},"data-placeholder":r,style:{minHeight:s}}),!e&&n&&a.jsx(Ie,{prompts:n,className:"text-base md:text-[17px] font-serif leading-relaxed text-apple-text dark:text-gray-100"})]})}),Ae=async()=>{const e=c().currentUser;if(!e)return{transcriptionSeconds:0,lastUpdated:Date.now()};try{const t=f(pe,"usage",e.uid),a=await y(t);if(!a.exists()){const e={transcriptionSeconds:0,lastUpdated:Date.now()};return await b(t,e),e}return a.data()}catch(t){return{transcriptionSeconds:0,lastUpdated:Date.now()}}},Le=e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,_e=({onTranscriptionComplete:e})=>{const[t,r]=o.useState("idle"),[n,s]=o.useState(0),[i,l]=o.useState(!0),[d,u]=o.useState("15:00"),[m,h]=o.useState(!1),g=o.useRef(null),p=o.useRef([]),x=o.useRef(null),y=o.useRef(0),w=o.useRef(0);o.useEffect(()=>{v()},[]);const v=async()=>{const e=await(async()=>(await Ae()).transcriptionSeconds<900)();l(e);const t=await(async()=>{const e=await Ae();return Math.max(0,900-e.transcriptionSeconds)})();u(Le(t)),t<180&&t>0&&h(!0)},j=()=>{g.current&&"recording"===t&&(g.current.pause(),r("paused"),x.current&&clearInterval(x.current))},k=()=>{g.current&&"paused"===t&&(g.current.resume(),r("recording"),x.current=setInterval(()=>{s(e=>e+1)},1e3))},N=()=>{!g.current||"recording"!==t&&"paused"!==t||(g.current.stop(),r("processing"),x.current&&clearInterval(x.current))},C=()=>{g.current&&(g.current.stop(),g.current.stream.getTracks().forEach(e=>e.stop())),x.current&&clearInterval(x.current),r("idle"),s(0),p.current=[]},D=async t=>{try{const a=await(async e=>{try{const t=await e.arrayBuffer(),a=btoa(new Uint8Array(t).reduce((e,t)=>e+String.fromCharCode(t),"")),r=await fetch("https://us-central1-data-journaling.cloudfunctions.net/transcribeAudio",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audioData:a})});if(!r.ok){const e=await r.json();throw new Error(e.error||"Transcription failed")}return(await r.json()).text||""}catch(t){throw new Error(`Transcription failed: ${(null==t?void 0:t.message)||"Unknown error"}`)}})(t);await(async e=>{const t=c().currentUser;if(t)try{const a=f(pe,"usage",t.uid);await S(a,{transcriptionSeconds:W(e),lastUpdated:Date.now()})}catch(a){try{const a=f(pe,"usage",t.uid);await b(a,{transcriptionSeconds:e,lastUpdated:Date.now()})}catch(r){}}})(n),await v();let o=a;o=o.replace(/^### (.+)$/gim,"<h2>$1</h2>"),o=o.replace(/^## (.+)$/gim,"<h2>$1</h2>"),o=o.replace(/^# (.+)$/gim,"<h1>$1</h1>"),o=o.replace(/^\* (.+)$/gim,"<ul><li>$1</li></ul>"),o=o.replace(/^- (.+)$/gim,"<ul><li>$1</li></ul>"),o=o.replace(/\*\*(.+?)\*\*/gim,"<b>$1</b>"),o=o.replace(/\n/gim,"<br>"),o=o.replace(/<\/ul><br><ul>/g,""),e(o),r("idle"),s(0)}catch(a){alert("Failed to transcribe. Please try again."),r("idle"),s(0)}};return i?"processing"===t?a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-full text-xs font-medium animate-pulse",children:[a.jsx(M,{className:"w-3 h-3"}),a.jsx("span",{children:"AI Processing..."})]}):"recording"===t||"paused"===t?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"px-3 py-1.5 bg-gray-100 dark:bg-zinc-800 rounded-full text-xs font-mono font-medium text-gray-700 dark:text-gray-300",children:(z=n,`${Math.floor(z/60)}:${(z%60).toString().padStart(2,"0")}`)}),a.jsx("button",{onClick:"recording"===t?j:k,className:"ripple-button p-2 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-full transition-all active:scale-95",title:"recording"===t?"Pause":"Resume",children:"recording"===t?a.jsx(A,{className:"w-4 h-4"}):a.jsx(L,{className:"w-4 h-4"})}),a.jsx("button",{onClick:N,className:"ripple-button p-2 bg-green-50 text-green-600 hover:bg-green-100 rounded-full transition-all active:scale-95",title:"Stop & Transcribe",children:a.jsx(_,{className:"w-4 h-4 fill-current"})}),a.jsx("button",{onClick:C,className:"ripple-button p-2 bg-red-50 text-red-600 hover:bg-red-100 rounded-full transition-all active:scale-95",title:"Cancel",children:a.jsx($,{className:"w-4 h-4"})})]}):a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("button",{onClick:async()=>{if(i)try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});g.current=new MediaRecorder(e),p.current=[],y.current=Date.now(),w.current=0,g.current.ondataavailable=e=>{e.data.size>0&&p.current.push(e.data)},g.current.onstop=async()=>{const t=new Blob(p.current,{type:"audio/mp3"});D(t),e.getTracks().forEach(e=>e.stop())},g.current.start(),r("recording"),x.current=setInterval(()=>{s(e=>e+1)},1e3)}catch(e){"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?alert("Microphone access was denied. Please check your browser permissions."):alert("Could not access microphone.")}else alert("You have used your 15-minute free trial. Please upgrade to continue using voice transcription.")},className:"ripple-button flex items-center gap-2 px-3 py-1.5 text-apple-gray hover:text-blue-600 hover:bg-blue-50 rounded-full transition-all",title:"Dictate with AI",children:[a.jsx(H,{className:"w-4 h-4"}),a.jsx("span",{className:"text-xs font-medium",children:"Dictate"})]}),m&&a.jsxs("span",{className:"text-xs text-amber-600 px-2",children:[d," left"]})]}):a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[a.jsx(I,{className:"w-3 h-3"}),a.jsx("span",{children:"Trial ended - Upgrade to continue"})]});var z},$e=i.memo(({status:e,size:t=24,className:r=""})=>"unlit"===e?a.jsx("div",{className:`relative flex items-center justify-center ${r}`,style:{width:t,height:t},children:a.jsx("svg",{width:"100%",height:"100%",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white/20",children:a.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.6-3.3.7 1.7 1.2 2.5 2.9 2.8z"})})}):a.jsx("div",{className:`relative flex items-center justify-center ${r}`,style:{width:t,height:t},children:a.jsxs("div",{className:"relative w-full h-full",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",className:"w-full h-full drop-shadow-[0_0_10px_rgba(255,100,0,0.5)]",style:{transformOrigin:"bottom center"},children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"flameGradient",x1:"12",y1:"2",x2:"12",y2:"22",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{offset:"0%",stopColor:"#fbbf24"}),a.jsx("stop",{offset:"50%",stopColor:"#f97316"}),a.jsx("stop",{offset:"100%",stopColor:"#ef4444"})]})}),a.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.6-3.3.7 1.7 1.2 2.5 2.9 2.8z",fill:"url(#flameGradient)",className:"animate-flame-outer",style:{transformOrigin:"center bottom"}}),a.jsx("path",{d:"M12 10c0-1 .5-2 1.5-2.5-1 1.5-1 2.5-1 3.5 0 1 .5 1.5 1 2-.5-.2-1-.8-1.5-1.5-.5.7-1 1.3-1.5 1.5.5-.5 1-1 1-2 0-1 0-2-1-3.5 1 .5 1.5 1.5 1.5 2.5z",fill:"#fff",fillOpacity:"0.8",className:"animate-flame-inner",style:{transformOrigin:"center bottom"}})]}),a.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden rounded-full",children:[a.jsx("div",{className:"absolute bottom-0 left-1/2 w-[2px] h-[2px] bg-yellow-200 rounded-full animate-ember-1"}),a.jsx("div",{className:"absolute bottom-0 left-1/2 w-[2px] h-[2px] bg-orange-200 rounded-full animate-ember-2"})]})]})})),He=({selectedDate:e,onSelectDate:t,entryDates:s,onClose:i})=>{const[l,c]=o.useState(new Date(e)),[d,u]=o.useState(0),m=e=>{const a=new Date(l.getFullYear(),l.getMonth(),e),r=a.getTimezoneOffset(),n=new Date(a.getTime()-60*r*1e3);t(n.toISOString().split("T")[0]),i()};return a.jsxs("div",{className:"p-4 bg-white/95 dark:bg-zinc-900/95 backdrop-blur-xl rounded-3xl shadow-2xl border border-gray-200/50 dark:border-white/10 w-[280px] sm:w-[300px] animate-in zoom-in-95 duration-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[a.jsx("button",{onClick:()=>{u(-1),c(new Date(l.getFullYear(),l.getMonth()-1,1))},className:"p-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded-full transition-colors",children:a.jsx(P,{className:"w-5 h-5 text-gray-500"})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:l.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),a.jsx("button",{onClick:()=>{u(1),c(new Date(l.getFullYear(),l.getMonth()+1,1))},className:"p-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded-full transition-colors",children:a.jsx(U,{className:"w-5 h-5 text-gray-500"})})]}),a.jsx("div",{className:"grid grid-cols-7 mb-2 text-center",children:["S","M","T","W","T","F","S"].map(e=>a.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider h-10 flex items-center justify-center",children:e},e))}),a.jsx("div",{className:"relative h-[280px] overflow-hidden",children:a.jsx(r,{initial:!1,custom:d,mode:"wait",children:a.jsx(n.div,{custom:d,variants:{enter:e=>({x:e>0?20:-20,opacity:0}),center:{x:0,opacity:1},exit:e=>({x:e>0?-20:20,opacity:0})},initial:"enter",animate:"center",exit:"exit",transition:{type:"spring",stiffness:300,damping:30},className:"grid grid-cols-7 place-items-center absolute w-full",children:(()=>{const t=[],r=(n=l,new Date(n.getFullYear(),n.getMonth()+1,0).getDate());var n;const o=(e=>new Date(e.getFullYear(),e.getMonth(),1).getDay())(l);for(let e=0;e<o;e++)t.push(a.jsx("div",{className:"h-10 w-10"},`empty-${e}`));for(let i=1;i<=r;i++){const r=new Date(l.getFullYear(),l.getMonth(),i).toLocaleDateString("en-CA"),n=r===e,o=s.includes(r),c=r===(new Date).toLocaleDateString("en-CA");t.push(a.jsxs("button",{onClick:()=>m(i),className:`\n            relative h-10 w-10 rounded-full flex items-center justify-center text-sm font-medium transition-all duration-200\n            ${n?"bg-black text-white dark:bg-white dark:text-black shadow-lg scale-105":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/10"}\n            ${c&&!n?"text-blue-600 dark:text-blue-400 font-bold":""}\n          `,children:[i,o&&!n&&a.jsx("div",{className:"absolute bottom-1.5 w-1 h-1 rounded-full bg-gray-400 dark:bg-gray-500"}),o&&n&&a.jsx("div",{className:"absolute bottom-1.5 w-1 h-1 rounded-full bg-white/50 dark:bg-black/50"})]},i))}return t})()},l.toISOString())})})]})},Pe=({isOpen:e,className:t=""})=>{const r=e?"opened":"closed";return a.jsxs("div",{className:`flex flex-col justify-center items-center w-6 h-6 gap-[10px] ${t}`,children:[a.jsx(n.span,{animate:r,variants:{closed:{rotate:0,translateY:0},opened:{rotate:45,translateY:6}},transition:{duration:.2,ease:"easeInOut"},className:"w-5 h-[2px] bg-current rounded-full origin-center block"}),a.jsx(n.span,{animate:r,variants:{closed:{rotate:0,translateY:0},opened:{rotate:-45,translateY:-6}},transition:{duration:.2,ease:"easeInOut"},className:"w-5 h-[2px] bg-current rounded-full origin-center block"})]})},Ue=i.memo(({date:e,setDate:t,showCalendar:r,setShowCalendar:n,entryDates:s,onToggleSidebar:i,isSidebarOpen:l=!1,streakStatus:c,displayStreak:d})=>{const u=o.useCallback(()=>{null==i||i()},[i]),m=o.useCallback(()=>{n(!r)},[r,n]),h=o.useCallback(e=>{t(e),n(!1)},[t,n]),g=o.useCallback(()=>{n(!1)},[n]);return a.jsx(a.Fragment,{children:a.jsxs("header",{className:"flex items-center gap-4 px-3 md:px-5 h-[var(--header-height)] border-b border-apple-border/60 dark:border-white/10 animate-slide-in-from-bottom bg-apple-bg/80 dark:bg-zinc-900/80 backdrop-blur-md sticky top-0 z-30 transition-all duration-300",style:{animationDelay:"0.1s"},children:[a.jsx("button",{onClick:u,className:"p-1.5 -ml-1 text-apple-gray dark:text-zinc-400 hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors active:scale-95 min-w-[36px] min-h-[36px] flex items-center justify-center group md:hidden lg:hidden","aria-label":"Toggle sidebar",children:a.jsx(Pe,{isOpen:l,className:"scale-90"})}),a.jsx("div",{className:"flex-1 flex items-center min-w-0 pt-0.5 ml-1 md:ml-0",children:a.jsxs("button",{onClick:m,className:"group flex items-center gap-1.5 md:gap-2 text-left hover:opacity-80 transition-opacity min-w-0",children:[a.jsx("h1",{className:"text-base md:text-2xl font-bold text-apple-text dark:text-white tracking-tight leading-none truncate",children:new Date(e).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),a.jsx(R,{className:"w-4 h-4 md:w-6 md:h-6 text-gray-400 transition-transform duration-300 flex-shrink-0 "+(r?"rotate-180":"")})]})}),a.jsx("div",{className:"flex items-center gap-2 ml-auto flex-shrink-0 pl-2",children:a.jsxs("div",{className:"\n              inline-flex items-center justify-center \n              h-[36px] lg:h-[48px] \n              px-2.5 rounded-full \n              bg-gradient-to-b from-[#2a1f1a] to-[#34221c] \n              border border-white/5 \n              shadow-[0_6px_18px_rgba(0,0,0,0.45)]\n              text-white\n            ","aria-label":`Streak ${d}`,children:[a.jsx($e,{size:20,status:c,className:"lg:w-5 lg:h-5"}),a.jsx("span",{className:"text-sm lg:text-[1rem] font-medium ml-1.5",children:d})]})}),r&&a.jsxs("div",{className:"absolute top-full left-0 mt-2 z-50 px-[var(--space-l)]",children:[a.jsx("div",{className:"fixed inset-0 z-40",onClick:g}),a.jsx("div",{className:"relative z-50",children:a.jsx(He,{selectedDate:e,onSelectDate:h,entryDates:s,onClose:g})})]})]})})}),Re=["Did you make a difficult decision today?","What is the cost of your current inaction?","What are you tolerating that you shouldn't be?","Who did you help today, and how?","What is one thing you learned today?","If you could live today over again, what would you do differently?","What made you smile today?","What are you grateful for right now?","What is a fear you overcame recently?","How did you take care of yourself today?","What is the most important task for tomorrow?","Who are you trying to impress, and why?","What would you do if you knew you couldn't fail?","What is a habit you want to break?","What is a habit you want to build?","How are you feeling physically right now?","How are you feeling emotionally right now?","What is draining your energy?","What gives you energy?","Who inspires you?","What is a dream you haven't pursued yet?","What does success look like to you?","What is a mistake you made recently, and what did you learn?","What is a compliment you received recently?","What is a compliment you gave recently?","What are you looking forward to?","What is holding you back?","How do you define happiness?","What is your biggest strength?","What is your biggest weakness?","What is a book that changed your life?","What is a song that moves you?","What is a movie that impacted you?","What is a place you want to visit?","Who do you miss?","What is a relationship you want to improve?","What is a boundary you need to set?","What is a risk you need to take?","What is a skill you want to learn?","What is a project you want to start?","What is a clutter you need to clear?","What is a conversation you need to have?","What is a belief that limits you?","What is a value you live by?","What is a memory you cherish?","What is a lesson your parents taught you?","What is a piece of advice you would give your younger self?","What is a goal you achieved recently?","What is a challenge you are facing?","How do you handle stress?","What makes you feel loved?","What makes you feel safe?","What makes you feel powerful?","What makes you feel vulnerable?","What is a lie you tell yourself?","What is the truth you need to hear?","What are you avoiding?","What are you procrastinating on?","What is a small win from today?","What is a big win from this week?","What is something you are proud of?","What is something you are ashamed of?","How can you be kinder to yourself?","How can you be kinder to others?","What does your ideal day look like?","What does your ideal life look like?","What is stopping you from living your ideal life?","What is one step you can take today towards your dreams?","Who supports you?","Who drains you?","What is a toxic pattern you need to break?","What is a healthy pattern you want to reinforce?","What is your definition of love?","What is your definition of freedom?","What is your definition of peace?","What is your definition of wealth?","What are you curious about?","What surprises you?","What bores you?","What excites you?","What angers you?","What saddens you?","What confuses you?","What clarifies things for you?","What is a question you want answered?","What is a problem you want to solve?","What is a cause you care about?","What is a legacy you want to leave?","How do you want to be remembered?","What is the meaning of life for you?","Are you living in alignment with your values?","What needs to change?","What needs to stay the same?","What are you waiting for?","Is today a good day to start?","What if it all works out?","What if you are enough?","What if you are exactly where you need to be?","What is the most beautiful thing you saw today?","What is the kindest thing someone did for you today?","What is the bravest thing you did today?","What is the most honest thing you said today?","What is the most creative thing you did today?","What is the most productive thing you did today?","What is the most relaxing thing you did today?","What is the most fun thing you did today?","What is the most interesting thing you read today?","What is the most inspiring thing you heard today?"],Fe=["What are you tolerating?","How is your energy right now?","What is the dominant emotion you feel?","Why do you think you feel this way?","What triggered your mood today?","Are you reacting or responding?","What is your body trying to tell you?","Where do you feel tension in your body?","What is draining your mental space?","What is feeding your soul?","Are you being honest with yourself?","What are you avoiding feeling?","What would make you feel better?","Is this feeling permanent or temporary?","What can you learn from this emotion?","How would you rate your stress level?","How would you rate your focus?","What is one thing you can let go of?","What is one thing you can embrace?","Are you being kind to yourself?"],Ge=["What is the cost of inaction?","What is the next logical step?","What is the worst that could happen?","What is the best that could happen?","Who can help you with this?","What resources do you need?","What is a small step you can take now?","What is a bold move you can make?","How can you simplify this?","What is the 80/20 of this situation?","What would your mentor do?","What is the long-term impact of this?","How does this align with your goals?","What are the alternatives?","What is the timeline?","How will you measure success?","What is the obstacle in the way?","How can you remove the obstacle?","What is the opportunity here?","What is your intuition telling you?"],Be=({initialDate:e,onSave:t,onToggleSidebar:r,isSidebarOpen:n,streak:s=0})=>{const{isGuest:i}=Te(),[l,c]=o.useState(e),[d,u]=o.useState(""),[m,h]=o.useState(null),[g,p]=o.useState(""),[x,f]=o.useState(""),[y,b]=o.useState(void 0),[w,v]=o.useState([]),[j,k]=o.useState(""),[N,S]=o.useState("saved"),[W,C]=o.useState(!0),[D,z]=o.useState(!1),[E,T]=o.useState([]),[O,I]=o.useState("burning"),[M,A]=o.useState(s);o.useEffect(()=>{A(s)},[s]),o.useEffect(()=>{(async()=>{C(!0);const t=await Ne(e),a=new Date(e).toDateString()===(new Date).toDateString(),r=t&&(t.narrative||t.rating||t.reasoning||t.planForTomorrow);I(a&&!r?"unlit":"burning"),t?(u(t.narrative),h(t.rating),p(t.reasoning),f(t.planForTomorrow),v(t.tags||[]),b(t.aiSummary)):(u(""),h(null),p(""),f(""),v([]),b(void 0)),C(!1),S("saved")})(),(async()=>{const e=await ie(()=>Promise.resolve().then(()=>De),void 0).then(e=>e.getEntries());T(e.map(e=>e.date))})()},[e]);const L=o.useCallback(async()=>{S("saving");const e={id:l,date:l,timestamp:Date.now(),narrative:d,rating:m||0,reasoning:g,planForTomorrow:x,tags:w,aiSummary:y,encrypted:i};try{await ke(e),setTimeout(()=>{S("saved"),t()},1e3)}catch(a){S("unsaved"),alert("Failed to save entry. Please check your connection.")}},[l,d,m,g,x,w,y,t,i]);o.useEffect(()=>{if(W)return;const e=setTimeout(()=>{(d||g||x||null!==m||w.length>0)&&L()},1500);return()=>clearTimeout(e)},[d,g,x,m,w,y,L,W]);const _=o.useCallback((e,t)=>{"journal"===t?u(t=>t+(t?" ":"")+e):"analysis"===t?p(t=>t+(t?" ":"")+e):"strategy"===t&&f(t=>t+(t?" ":"")+e),S("saving")},[]),$=o.useCallback(e=>{u(e),S("saving")},[]),H=o.useCallback(e=>{p(e),S("saving")},[]),P=o.useCallback(e=>{f(e),S("saving")},[]),U=o.useCallback(e=>{h(e),S("saving")},[]),R=o.useCallback(()=>{j.trim()&&!w.includes(j.trim())&&(v([...w,j.trim()]),k(""))},[j,w]),B=o.useCallback(e=>{v(w.filter(t=>t!==e))},[w]),J=o.useCallback(e=>{"Enter"===e.key&&R()},[R]);return W?a.jsx("div",{className:"flex items-center justify-center h-64 text-apple-gray dark:text-zinc-500",children:"Loading entry..."}):a.jsxs("div",{className:"w-full pb-32 animate-fade-in @container",children:[a.jsx("div",{className:"fixed bottom-6 right-6 z-40 flex flex-col items-end gap-2 pointer-events-none",children:a.jsx("span",{className:"text-xs font-medium px-3 py-1.5 rounded-full border shadow-sm backdrop-blur-sm transition-all duration-500 "+("saving"===N?"opacity-100 translate-y-0 bg-white/90 dark:bg-zinc-800/90 dark:border-zinc-600 dark:text-white":"unsaved"===N?"opacity-100 translate-y-0 bg-red-50/90 text-red-600 border-red-100":"opacity-0 translate-y-2"),children:"saving"===N?"Saving...":"Save Failed"})}),a.jsx(Ue,{date:l,setDate:c,showCalendar:D,setShowCalendar:z,entryDates:E,onToggleSidebar:r,isSidebarOpen:n,streak:s,streakStatus:O,displayStreak:M}),a.jsxs("div",{className:"mx-auto max-w-4xl px-3 md:px-5 space-y-4 md:space-y-6",children:[a.jsxs("section",{className:"group animate-slide-in-from-bottom @container",style:{animationDelay:"0.2s"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-[var(--space-s)]",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[0.85rem] tracking-[2px] uppercase text-apple-gray dark:text-white/20 font-medium",children:"NARRATIVE"}),a.jsx("span",{className:"text-sm text-apple-gray/60 dark:text-white/10",children:"•"}),a.jsx("span",{className:"text-sm text-apple-gray dark:text-gray-400",children:"What happened today?"})]}),a.jsx("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(_e,{onTranscriptionComplete:e=>_(e,"journal")})})]}),a.jsx("div",{className:"bg-white/50 dark:bg-white/[0.02] rounded-xl p-3 md:p-[var(--space-m)] border border-apple-border/50 dark:border-white/5 shadow-sm backdrop-blur-sm transition-all hover:bg-white/80 dark:hover:bg-white/[0.04]",children:a.jsx(Me,{value:d,onChange:$,animatedPlaceholder:Re})})]}),a.jsxs("section",{className:"group animate-slide-in-from-bottom @container",style:{animationDelay:"0.3s"},children:[a.jsx("div",{className:"flex items-center justify-between mb-[var(--space-s)]",children:a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-[0.85rem] tracking-[2px] uppercase text-apple-gray dark:text-white/20 font-medium",children:"ANALYSIS & MOOD"})})}),a.jsxs("div",{className:"bg-white/50 dark:bg-white/[0.02] rounded-xl p-3 md:p-[var(--space-m)] border border-apple-border/50 dark:border-white/5 shadow-sm backdrop-blur-sm transition-all hover:bg-white/80 dark:hover:bg-white/[0.04]",children:[a.jsx("div",{className:"mb-[var(--space-m)]",children:a.jsx(Oe,{value:m,onChange:U})}),a.jsx("div",{children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm text-apple-gray dark:text-gray-400",children:"Why do you feel this way?"}),a.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(_e,{onTranscriptionComplete:e=>_(e,"analysis")})})]}),a.jsx(Me,{value:g,onChange:H,animatedPlaceholder:Fe})]})})]})]}),a.jsxs("section",{className:"group animate-slide-in-from-bottom @container",style:{animationDelay:"0.4s"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-[var(--space-s)]",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[0.85rem] tracking-[2px] uppercase text-apple-gray dark:text-white/20 font-medium",children:"STRATEGY"}),a.jsx("span",{className:"text-sm text-apple-gray/60 dark:text-white/10",children:"•"}),a.jsx("span",{className:"text-sm text-apple-gray dark:text-gray-400",children:"Plan for tomorrow"})]}),a.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(_e,{onTranscriptionComplete:e=>_(e,"strategy")})})]}),a.jsx("div",{className:"bg-white/50 dark:bg-white/[0.02] rounded-xl p-3 md:p-[var(--space-m)] border border-apple-border/50 dark:border-white/5 shadow-sm backdrop-blur-sm transition-all hover:bg-white/80 dark:hover:bg-white/[0.04]",children:a.jsx(Me,{value:x,onChange:P,animatedPlaceholder:Ge})})]})]}),a.jsx("section",{className:"pt-8 mt-[var(--space-l)] border-t border-gray-200/60 dark:border-white/10 animate-slide-in-from-bottom",style:{animationDelay:"0.6s"},children:a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-apple-gray dark:text-zinc-400 bg-gray-100 dark:bg-zinc-800/80 px-4 py-2 rounded-full transition-colors hover:bg-gray-200 dark:hover:bg-zinc-700",children:[a.jsx(F,{className:"w-4 h-4"}),a.jsx("input",{type:"text",value:j,onChange:e=>k(e.target.value),onKeyDown:J,placeholder:"Add tag",className:"bg-transparent border-none outline-none text-sm min-w-[80px] placeholder:text-gray-400 focus:ring-0"}),a.jsx("button",{onClick:R,className:"w-5 h-5 flex items-center justify-center rounded-full hover:bg-white dark:hover:bg-zinc-600 text-apple-gray transition-colors",children:a.jsx(G,{className:"w-3 h-3"})})]}),w.map(e=>a.jsxs("span",{onClick:()=>B(e),className:"px-4 py-1.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-300 rounded-full text-sm font-medium cursor-pointer hover:bg-blue-100 dark:hover:bg-blue-900/40 transition-colors",children:["#",e]},e))]})})]})},Je=()=>{const{loginGoogle:e,loginGuest:t,loginEmail:r,registerEmail:n,loading:s}=Te(),[i,l]=o.useState(null),[c,d]=o.useState(null),[u,m]=o.useState(!1),[h,g]=o.useState(!1),[p,x]=o.useState(!1),[f,y]=o.useState(""),[b,w]=o.useState("");o.useEffect(()=>{"localhost"!==window.location.hostname&&window.location.hostname.includes("127.0.0.1")},[]);return a.jsx("div",{className:"min-h-screen w-full flex flex-col items-center justify-center bg-apple-bg dark:bg-zinc-900 text-apple-text dark:text-white p-4 transition-colors duration-500",children:a.jsxs("div",{className:"w-full max-w-md animate-fade-in",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-[2rem] bg-white dark:bg-zinc-800 shadow-float mb-8 animate-zoom-in",children:a.jsx(B,{className:"w-12 h-12 text-apple-text dark:text-white"})}),a.jsx("h1",{className:"text-4xl font-bold tracking-tight mb-3 animate-slide-in-from-bottom",style:{animationDelay:"0.1s"},children:"Data Journaling"}),a.jsx("p",{className:"text-apple-gray dark:text-zinc-400 text-lg animate-slide-in-from-bottom",style:{animationDelay:"0.2s"},children:"Your life, beautifully documented."})]}),a.jsxs("div",{className:"bg-white/70 dark:bg-zinc-800/50 backdrop-blur-2xl rounded-[2.5rem] p-10 shadow-float border border-white/40 dark:border-white/5 overflow-hidden animate-slide-in-from-bottom",style:{animationDelay:"0.3s"},children:[c&&a.jsxs("div",{className:"mb-6 p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-100 dark:border-orange-800 rounded-2xl text-sm",children:[a.jsxs("div",{className:"flex items-start gap-3 text-orange-800 dark:text-orange-200 mb-3",children:[a.jsx(J,{className:"w-5 h-5 shrink-0 mt-0.5"}),a.jsx("span",{className:"font-bold",children:"Action Required: Whitelist Domain"})]}),a.jsx("p",{className:"text-orange-700 dark:text-orange-300 mb-3 leading-relaxed",children:"Google blocked the login because this preview domain is not on your Firebase safe list."}),a.jsx("div",{className:"bg-white/50 dark:bg-black/20 p-2 rounded mb-3 font-mono text-xs break-all border border-orange-200 dark:border-orange-800 text-center",children:c}),a.jsxs("button",{onClick:()=>{const e=c||window.location.hostname;navigator.clipboard.writeText(e),m(!0),setTimeout(()=>m(!1),2e3)},className:"w-full flex items-center justify-center gap-2 bg-white dark:bg-black/40 border border-orange-200 dark:border-orange-800 p-2.5 rounded-lg text-orange-800 dark:text-orange-200 font-semibold text-xs hover:bg-orange-100 dark:hover:bg-orange-900/40 transition-colors shadow-sm",children:[u?a.jsx(Y,{className:"w-4 h-4"}):a.jsx(V,{className:"w-4 h-4"}),u?"Copied!":"Copy Domain"]}),a.jsxs("p",{className:"mt-3 text-[11px] text-orange-600 dark:text-orange-400 text-center",children:["Or use ",a.jsx("strong",{children:"Guest Mode"})," below to skip this."]})]}),i&&!c&&a.jsx("div",{className:"mb-6 p-3 bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-800 rounded-xl text-red-600 dark:text-red-400 text-sm font-medium text-center",children:i}),h?a.jsxs("form",{onSubmit:async e=>{var t;e.preventDefault(),l(null),d(null);try{p?await n(f,b):await r(f,b)}catch(a){if("auth/unauthorized-domain"===(null==a?void 0:a.code)||(null==(t=null==a?void 0:a.message)?void 0:t.includes("unauthorized-domain")))return void d(window.location.hostname);l((null==a?void 0:a.message)||"Authentication failed.")}},className:"space-y-5 animate-slide-in-from-right",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-zinc-400 mb-2 uppercase tracking-wider",children:"Email Address"}),a.jsx("input",{type:"email",required:!0,value:f,onChange:e=>y(e.target.value),className:"w-full px-4 py-3.5 rounded-2xl bg-gray-50 dark:bg-zinc-900/50 border border-gray-200 dark:border-zinc-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-zinc-400 mb-2 uppercase tracking-wider",children:"Password"}),a.jsx("input",{type:"password",required:!0,value:b,onChange:e=>w(e.target.value),className:"w-full px-4 py-3.5 rounded-2xl bg-gray-50 dark:bg-zinc-900/50 border border-gray-200 dark:border-zinc-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",placeholder:"••••••••",minLength:6})]}),a.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-2xl shadow-lg shadow-blue-200 dark:shadow-none transition-all active:scale-[0.98]",children:s?"Processing...":p?"Create Account":"Sign In"}),a.jsxs("div",{className:"flex items-center justify-between text-sm pt-2",children:[a.jsx("button",{type:"button",onClick:()=>g(!1),className:"text-gray-500 hover:text-gray-800 dark:hover:text-gray-300 font-medium",children:"Back"}),a.jsx("button",{type:"button",onClick:()=>x(!p),className:"text-blue-600 hover:underline font-medium",children:p?"Already have an account?":"Create an account"})]})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("button",{onClick:async()=>{var t;try{l(null),d(null),await e()}catch(a){if("auth/unauthorized-domain"===(null==a?void 0:a.code)||(null==(t=null==a?void 0:a.message)?void 0:t.includes("unauthorized-domain"))||String(a).includes("auth/unauthorized-domain"))return void d(window.location.hostname);if("auth/popup-closed-by-user"===(null==a?void 0:a.code))return void l("Sign-in cancelled.");l((null==a?void 0:a.message)||"Unable to sign in with Google.")}},disabled:s,className:"w-full flex items-center justify-center gap-3 bg-apple-text dark:bg-white text-white dark:text-black font-semibold py-4 rounded-2xl transition-transform active:scale-[0.98] hover:shadow-lg disabled:opacity-70",children:s?"Connecting...":a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z"}),a.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),a.jsx("span",{children:"Continue with Google"})]})}),a.jsxs("button",{onClick:()=>g(!0),className:"w-full flex items-center justify-center gap-2 bg-white dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700 text-apple-text dark:text-white font-medium py-4 rounded-2xl hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:[a.jsx(q,{className:"w-5 h-5"}),a.jsx("span",{children:"Continue with Email"})]}),a.jsxs("div",{className:"relative py-3",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-200 dark:border-zinc-700"})}),a.jsx("div",{className:"relative flex justify-center",children:a.jsx("span",{className:"bg-transparent px-2 text-xs text-gray-400 uppercase tracking-wider font-semibold",children:"Or"})})]}),a.jsxs("button",{onClick:t,className:"w-full flex items-center justify-center gap-2 bg-gray-100 dark:bg-zinc-700/50 text-apple-text dark:text-white font-medium py-4 rounded-2xl hover:bg-gray-200 dark:hover:bg-zinc-600 transition-colors group",children:[a.jsx("span",{children:"Continue as Guest"}),a.jsx(K,{className:"w-4 h-4 opacity-50 group-hover:translate-x-1 transition-transform"})]})]}),a.jsxs("div",{className:"mt-10 flex items-center justify-center gap-2 text-[10px] text-gray-400 dark:text-zinc-500 uppercase tracking-wide font-medium",children:[a.jsx(Z,{className:"w-3 h-3"}),a.jsx("span",{children:"Guest data encrypted locally."})]})]})]})})};class Ye extends o.Component{constructor(){super(...arguments),t(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){var e;return this.state.hasError?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 p-4",children:a.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl max-w-md w-full border border-red-100",children:[a.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an unexpected error."}),a.jsx("div",{className:"bg-gray-100 p-4 rounded text-sm font-mono text-red-800 mb-6 overflow-auto max-h-40",children:(null==(e=this.state.error)?void 0:e.message)||"Unknown error"}),a.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 transition-colors",children:"Reload Application"})]})}):this.props.children}}const Ve=()=>{const[e,t]=o.useState(0),[r,n]=o.useState(0);o.useEffect(()=>{s()},[]);const s=async()=>{const e=await Ae();t(e.transcriptionSeconds);const a=Math.min(100,e.transcriptionSeconds/900*100);n(a)},i=Math.max(0,900-e),l=i<180;return a.jsxs("div",{className:"px-4 py-3 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-100 dark:border-blue-800/30",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Q,{className:"w-4 h-4 "+(l?"text-amber-500":"text-blue-500")}),a.jsx("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"AI Transcription"})]}),a.jsx(X,{className:"w-3 h-3 text-gray-400"})]}),a.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mb-2",children:a.jsx("div",{className:"h-full transition-all duration-500 "+(r>80?"bg-gradient-to-r from-amber-500 to-red-500":"bg-gradient-to-r from-blue-500 to-indigo-500"),style:{width:`${r}%`}})}),a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsxs("span",{className:"font-medium "+(l?"text-amber-600 dark:text-amber-400":"text-gray-600 dark:text-gray-400"),children:[Le(i)," remaining"]}),a.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:[Le(e)," / 15:00"]})]}),l&&i>0&&a.jsx("div",{className:"mt-2 text-xs text-amber-600 dark:text-amber-400 font-medium",children:"⚠️ Running low - Upgrade soon"}),0===i&&a.jsx("div",{className:"mt-2 text-xs text-red-600 dark:text-red-400 font-medium",children:"Trial ended - Upgrade to continue"})]})},qe=({icon:e,label:t,active:r,onClick:n,collapsed:s=!1})=>a.jsxs("button",{onClick:n,className:`\n      w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all duration-200 group\n      ${r?"bg-black/5 dark:bg-white/10 text-gray-900 dark:text-white font-medium":"text-gray-500 dark:text-gray-400 hover:bg-black/5 dark:hover:bg-white/5 hover:text-gray-900 dark:hover:text-gray-200"}\n      ${s?"justify-center px-0":""}\n    `,title:s?t:void 0,children:[a.jsx(e,{size:20,className:"transition-colors "+(r?"text-gray-900 dark:text-white":"group-hover:text-gray-900 dark:group-hover:text-gray-200")}),!s&&a.jsx("span",{className:"truncate text-sm",children:t})]}),Ke=({isOpen:e,onToggle:t,currentView:s,onViewChange:i,user:l,onOpenSettings:c,isMobile:d,isTablet:u})=>{const{logout:m}=Te(),h=o.useCallback(e=>{i(e),d&&t()},[i,d,t]),g=o.useCallback(()=>{c(),d&&t()},[c,d,t]),p=({collapsed:e=!1})=>{var t,r;return a.jsxs("div",{className:"flex flex-col h-full bg-apple-bg/95 dark:bg-[#1c1c1e]/95 backdrop-blur-xl border-r border-black/5 dark:border-white/5",children:[a.jsxs("div",{className:`flex items-center ${e?"justify-center p-4":"px-4 py-5 gap-3"} mb-2`,children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold shadow-sm flex-shrink-0",children:(null==l?void 0:l.photoURL)?a.jsx("img",{src:l.photoURL,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):(null==(r=null==(t=null==l?void 0:l.displayName)?void 0:t[0])?void 0:r.toUpperCase())||"M"}),!e&&a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:(null==l?void 0:l.displayName)||"Journaler"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:"Free Plan"})]})]}),a.jsxs("div",{className:"flex-1 px-3 space-y-1 overflow-y-auto no-scrollbar",children:[a.jsx(qe,{icon:ee,label:"Journal",active:"journal"===s,onClick:()=>h("journal"),collapsed:e}),a.jsx(qe,{icon:te,label:"History",active:"history"===s,onClick:()=>h("history"),collapsed:e})]}),!e&&a.jsx("div",{className:"px-3 mb-3",children:a.jsx(Ve,{})}),a.jsxs("div",{className:"p-3 mt-auto border-t border-black/5 dark:border-white/5 space-y-1",children:[a.jsx(qe,{icon:ae,label:"Settings",onClick:g,collapsed:e}),a.jsx(qe,{icon:re,label:"Sign Out",onClick:m,collapsed:e})]})]})};if(d)return a.jsx(r,{children:e&&a.jsxs(a.Fragment,{children:[a.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},onClick:t,className:"fixed inset-0 bg-black/50 z-40 backdrop-blur-[2px]"}),a.jsx(n.aside,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed top-0 left-0 bottom-0 w-auto min-w-[220px] max-w-[50vw] z-50 shadow-2xl",children:a.jsx(p,{})})]})});const x=u?e?240:72:260;return a.jsx(n.aside,{initial:!1,animate:{width:x},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 bottom-0 z-30 overflow-hidden border-r border-black/5 dark:border-white/5 bg-apple-bg dark:bg-[#1c1c1e]",children:a.jsx(p,{collapsed:u&&!e})})},Ze=i.lazy(()=>ie(()=>import("./HistoryDashboard-BuaRsKSh.js"),__vite__mapDeps([0,1,2,3,4]))),Qe=i.lazy(()=>ie(()=>import("./SettingsModal-BpnzfDNH.js"),__vite__mapDeps([5,1,2,4,3]))),Xe=i.lazy(()=>ie(()=>import("./ContactModal-CMv61ntK.js"),__vite__mapDeps([6,1,2,3]))),et=()=>{const{user:e,isGuest:t,loading:r,isPro:n,usage:s}=Te(),[i,l]=o.useState("journal"),[c,d]=o.useState(null),[u,m]=o.useState(0),[h,g]=o.useState(!1),[p,x]=o.useState(!1),[f,y]=o.useState(!1),[b,w]=o.useState(window.innerWidth<600),[v,j]=o.useState(window.innerWidth>=600&&window.innerWidth<1024),[k,N]=o.useState(!0);o.useEffect(()=>{const e=()=>{const e=window.innerWidth,t=e<600,a=e>=600&&e<1024;w(t),j(a),N(!t&&!a)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),o.useEffect(()=>{(async()=>{if(e||t){await je();const e=await Ce();m(e),g(!0)}})()},[e,t]),o.useEffect(()=>{h&&S()},[i,h]);const S=async()=>{const e=await Ce();m(e)};return r?a.jsx("div",{className:"h-screen w-full flex items-center justify-center bg-apple-bg dark:bg-zinc-900 text-apple-gray",children:"Loading..."}):e||t?h?a.jsxs("div",{className:"h-screen w-full flex bg-apple-bg dark:bg-zinc-900 transition-colors duration-500 overflow-hidden",children:[a.jsxs(o.Suspense,{fallback:null,children:[a.jsx(Qe,{isOpen:p,onClose:()=>x(!1),onUpgrade:()=>{},onContact:()=>y(!0)}),a.jsx(Xe,{isOpen:f,onClose:()=>y(!1)})]}),a.jsx(Ke,{isOpen:k,onToggle:()=>N(!k),currentView:i,onViewChange:e=>{l(e),d(null)},user:e,streak:u,onOpenSettings:()=>x(!0),isMobile:b,isTablet:v,isPro:n,usage:s?{count:s.transcriptionSeconds,limit:300}:void 0}),a.jsx("div",{className:`\n          flex-1 h-full relative transition-all duration-300 ease-in-out\n          ${b?"ml-0 w-full":""}\n          ${!b&&v?k?"ml-[240px]":"ml-[72px]":""}\n          ${b||v?"":"ml-[260px]"}\n        `,children:a.jsx("main",{className:"h-full overflow-y-auto no-scrollbar scroll-smooth pb-safe-bottom",children:a.jsx("div",{className:"max-w-5xl mx-auto px-3 md:px-8 py-3 md:py-6 min-h-full",children:"journal"===i?a.jsx(Be,{initialDate:c||(new Date).toISOString().split("T")[0],onSave:S,onUpgrade:()=>{},onToggleSidebar:b||v?()=>N(!k):void 0,isSidebarOpen:k,streak:u}):a.jsx(o.Suspense,{fallback:a.jsx("div",{className:"p-10 text-center text-gray-400",children:"Loading Index..."}),children:a.jsx(Ze,{onEditEntry:e=>{d(e),l("journal")}})})})})})]}):a.jsx("div",{className:"h-screen w-full flex items-center justify-center bg-apple-bg dark:bg-zinc-900",children:a.jsx("div",{className:"text-apple-gray text-sm font-medium animate-pulse",children:"Synchronizing Journal..."})}):a.jsx(Je,{})};function tt(){return a.jsx(Ye,{children:a.jsx(Ee,{children:a.jsx(et,{})})})}const at=document.getElementById("root");if(!at)throw new Error("Could not find root element to mount to");ne.createRoot(at).render(a.jsx(i.StrictMode,{children:a.jsx(tt,{})}));export{he as a,pe as b,We as d,Se as g,Te as u};
